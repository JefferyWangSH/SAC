# Stochastic Analytic Continuation [![forthebadge](https://forthebadge.com/images/badges/works-on-my-machine.svg)](https://forthebadge.com)


Primary C++ implementation of Stochastic Analytic Continuation method `(SAC)`,
proposed by Anders W. Sandvik, is presented in this repository. 

The program is aimed to extract information of fermion spectrum functions from imaginary-time quantum Monte Carlo `(QMC)` data. 
More details about `SAC` algorithm can be found in [References](#references) section. 

---

## Installation ##

### Prerequisite ###
* gcc / g++ and cmake ( version > 3.21.1 ) installed.
* Boost C++ libraries ( version > 1.71 ) installed.
* Eigen library ( version > 3.3.9 ), linked to Intel Math Kernel Library ( MKL ).
* `mkl_lapacke.h` for high-accuracy linear algebra, especially matrix diagonalization.

### Usage ###
1. Download source codes from github:
    ``` shell
    $ git clone git@github.com:JefferyWangSH/SAC.git sac
    ```
2. Creat empty directory `build` for program compilation:
    ``` shell
    $ mkdir ./sac/build && cd ./sac/build
    ```
3. Cmake and make:
    ``` shell
    $ cmake .. && make
    ```
4. Run the code and using command line option `--help` to see helping messages:
    ``` shell
    $ ./sac --help
    ```
5. Input QMC data, including time sequence and correlation functions, should be put in `input` folder,
   and some examples can be found there to show the format. 
   After the simulation, results of recovered spectrum will be automatically generated in `results` folder.
   Names of input and output files can be customized using program options:
   ``` shell
    $ ./sac --itau ../input/tau.dat --icor ../input/corr.dat --ospec ../results/spec.dat
   ```


## Repository Structure ##
* [`include/`](include) & [`src/`](src) - header file declarations and source codes 
  * [`SAC.h`](include/SAC.h)/[`SAC.cpp`](src/SAC.cpp) 
    \- main class for SAC calculations, implementing MC sampling, simulated annealing, and spectrum recovery e.g.
  * [`ReadInModule.h`](include/ReadInModule.h)/[`ReadInModule.cpp`](src/ReadInModule.cpp)
    \- interface module for analysis and pretreatments of input QMC data
  * [`FrequencyGrid.h`](include/FrequencyGrid.h)/[`FrequencyGrid.cpp`](src/FrequencyGrid.cpp)
    \- helping class for the division of grids in frequency domain, both grids for MC sampling and spectrum collection are supported
  * [`Kernel.h`](include/Kernel.h)/[`Kernel.cpp`](src/Kernel.cpp)
    \- integral kernels connecting spectrum function to QMC correlations
  * [`AnnealChain.h`](include/AnnealChain.h)/[`AnnealChain.cpp`](src/AnnealChain.cpp)
    \- structure and class to store simulating information during the SAC annealing process
  * [`Measure.h`](include/Measure.h)/[`Measure.cpp`](src/Measure.cpp)
    \- class for the measurements of average fitting goodness and accepting radio
  * [`DiagonalTools.hpp`](src/DiagonalTools.hpp) 
    \- C++ and Eigen style interface file for high-efficiency matrix diagonalization, encapsulating MKL LAPACK
  * [`main.cpp`](src/main.cpp) 
    \- the main program
* [`input/`](input) - input file for SAC simulations.
  * [`benchmark/`](input/benchmark) - benchmark input for the correctness testing of codes
      * [`tau.dat`](input/benchmark/tau.dat) 
        \- sequence of imaginary time points
      * [`cor.dat`](input/benchmark/cor.dat) 
        \- synthetic correlation functions with Gaussian noise introduced
      * [`spec_base.dat`](input/benchmark/spec_base.dat)
        \- standard spectral function to be benchmarked
* [`results/`](results) - simulation results
  * [`benchmark/`](results/benchmark) - results of benchmark calculation
    * [`log.log`](results/benchmark/log.log) 
      \- log file generated during the simulated annealing process of SAC. 
      Sampling temperature, fitting goodness and average accepting radio are recorded for tracking of annealing and equilibrium.
    * [`spec.dat`](results/benchmark/spec.dat) 
      \- spectrum data generated by SAC
    * [`benchmark.pdf`](results/benchmark/benchmark.pdf) - figure of test spectrum
  * [`script.py`](results/script.py)
      \- python script to plot the recovered spectrum
* [`references/`](references) - references and some reading materials about SAC algorithms


## References ##
<span id="reference"></span>

1. Anders W. Sandvik, 
   Stochastic method for analytic continuation of quantum Monte, 
   *Phys. Rev. B 57, 10287*, 1998. [DOI](https://doi.org/10.1103/PhysRevB.57.10287)
2. K. S. D. Beach, 
   Identifying the maximum entropy method as a special limit of stochastic analytic continuation,
   *arXiv:cond-mat/040305*, 2004. [DOI](http://arxiv.org/abs/cond-mat/0403055)  
3. Hui Shao, Yan Qi Qin, Sylvain Capponi et al.,
   Nearly Deconfined Spinon Excitations in the Square-Lattice Spin-1/2 Heisenberg Antiferromagnet,
   *Phys. Rev. X 7, 041072*, 2017. [DOI](https://link.aps.org/doi/10.1103/PhysRevX.7.041072)


## License & Support ##

The code is free software under GPL-3.0 License.

I would like to sincerely thank Prof. Hui Shao and Zheng Zhou for the generous sharing of their source codes in Fortran.

If any questions, please feel free to contact me via email 17307110117@fudan.edu.cn.